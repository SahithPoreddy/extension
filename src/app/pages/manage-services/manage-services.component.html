<div class="dashboard-layout">
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <mat-icon class="logo-icon">handyman</mat-icon>
        <span class="logo-text">UrbanFix Partners</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      @for (item of menuItems; track item.route) {
      <a
        class="nav-item"
        [class.active]="isActive(item.route)"
        (click)="navigate(item.route)"
      >
        <mat-icon class="nav-icon">{{ item.icon }}</mat-icon>
        <span class="nav-label">{{ item.name }}</span>
        @if (item.badge) {
        <span class="nav-badge">{{ item.badge }}</span>
        }
      </a>
      }
    </nav>
  </aside>

  <!-- Main Content Area -->
  <div class="main-content">
    <!-- Top Header -->
    <header class="top-header">
      <div class="header-left">
        <h1 class="page-title">Manage Services</h1>
        <p class="page-subtitle">Add, edit, or remove the services you offer</p>
      </div>
      <div class="header-right">
        <button
          mat-raised-button
          class="add-service-btn"
          (click)="openAddServiceDialog()"
        >
          <mat-icon>add</mat-icon>
          Add New Service
        </button>
        <button
          mat-icon-button
          [matMenuTriggerFor]="userMenu"
          class="user-menu-btn"
        >
          <mat-icon>account_circle</mat-icon>
        </button>
        <mat-menu #userMenu="matMenu">
          <button mat-menu-item (click)="navigate('profile')">
            <mat-icon>person</mat-icon>
            <span>Profile</span>
          </button>
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Logout</span>
          </button>
        </mat-menu>
      </div>
    </header>

    <!-- Services Content -->
    <div class="services-content">
      @if (services.length === 0) {
      <div class="empty-state">
        <mat-icon class="empty-icon">build_circle</mat-icon>
        <h2>No Services Yet</h2>
        <p>Start by adding your first service to attract customers</p>
        <button
          mat-raised-button
          class="add-service-btn"
          (click)="openAddServiceDialog()"
        >
          <mat-icon>add</mat-icon>
          Add Your First Service
        </button>
      </div>
      } @else {
      <div class="services-list">
        @for (service of services; track service.id) {
        <div class="service-card">
          <div class="service-header">
            <div class="service-title-section">
              <h3 class="service-title">{{ service.title }}</h3>
              <span class="service-category">{{
                getCategoryName(service.category)
              }}</span>
            </div>
            <div class="service-actions">
              <div class="status-toggle">
                <span class="status-label">Active</span>
                <mat-slide-toggle
                  [checked]="service.isActive"
                  (change)="toggleServiceStatus(service)"
                  color="primary"
                ></mat-slide-toggle>
              </div>
              <button
                mat-icon-button
                (click)="openEditServiceDialog(service)"
                class="edit-btn"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                (click)="openDeleteConfirmDialog(service)"
                class="delete-btn"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>

          <div class="service-body">
            <p class="service-description">{{ service.description }}</p>

            <div class="service-details">
              <div class="detail-item">
                <span class="detail-label">Pricing:</span>
                <span class="detail-value">
                  @if (service.applyOffer && service.discountPercentage) {
                  <span class="original-price">₹{{ service.price }}</span>
                  <span class="discounted-price"
                    >₹{{ getDiscountedPrice(service) }}</span
                  >
                  <span class="discount-badge"
                    >{{ service.discountPercentage }}% OFF</span
                  >
                  } @else { ₹{{ service.price }}
                  }
                </span>
              </div>

              <div class="detail-item">
                <span class="detail-label">Duration:</span>
                <span class="detail-value">{{ service.duration }} mins</span>
              </div>
            </div>

            @if (service.applyOffer && service.offerTitle) {
            <div class="offer-badge-container">
              <span class="offer-badge">
                <mat-icon>local_offer</mat-icon>
                {{ service.offerTitle }}
              </span>
            </div>
            }
          </div>
        </div>
        }
      </div>
      }
    </div>
  </div>
</div>
